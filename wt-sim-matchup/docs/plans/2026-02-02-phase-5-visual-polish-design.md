# Phase 5: Visual Polish — Design Document

**Date:** 2026-02-02
**Model:** OPUS
**Status:** Design approved

---

## Scope

Subtle visual polish for the Flight Academy, Tactical Playbook, and Mission Planner features. Also fixes header inconsistency and investigates rendering issues found during visual review.

### What's IN scope
1. Corner bracket decorations on all AI-feature cards
2. Scanline texture on empty/loading/error states
3. AI-generated content badge (green accent)
4. Header unification (Mission Planner → main app header)
5. Bug investigation: Flight Academy empty state visibility, weekly schedule overflow

### What's NOT in scope
- Changing the existing amber color palette
- Adding phosphor-green to section labels or data readouts
- Full-page scanline effects
- Changes to the home page, matchup page, or comparison page

---

## Task 1: Corner Bracket CSS Utility

### Implementation
Add a `.corner-brackets` CSS class in `src/index.css` using pseudo-elements.

```css
.corner-brackets {
  position: relative;
}

.corner-brackets::before,
.corner-brackets::after,
.corner-brackets > .bracket-inner::before,
.corner-brackets > .bracket-inner::after {
  content: '';
  position: absolute;
  width: 8px;
  height: 8px;
  border-color: rgba(212, 168, 67, 0.4); /* aviation-amber/40 */
  border-style: solid;
  pointer-events: none;
}
```

**Problem:** CSS pseudo-elements only give 2 corners per element (::before and ::after). For 4 corners, options:
- **Option A:** Add a wrapper `<div className="bracket-inner">` inside each card (extra DOM)
- **Option B:** Use a single `background-image` with 4 corner bracket SVGs (no extra DOM)
- **Option C:** Use `outline` + `clip-path` trick
- **Option D:** Use CSS `border-image` with a custom SVG

**Chosen: Option B** — A CSS background-image approach using inline SVG data URIs. Zero extra DOM elements, works on any element, single class to apply.

Actual implementation: Use `::before` with a full-size overlay that has 4 corner bracket shapes via `background-image: url("data:image/svg+xml,...")`. The SVG contains 4 L-shaped corner marks.

### Where applied
- `FlightAcademyTab.tsx` — All section cards (TacticalOverview, PerformanceQuickStats, CombatTacticsSection, EnergyManagementDiagram, PerformanceEnvelope, MatchupThreatMatrix, MECControlPanel)
- `TacticalPlaybookTab.tsx` — All section cards (ThreatAssessmentCard, EngagementPrinciplesCard, TacticalScenarioCard, AltitudeAdvantageChart)
- `MissionPlannerPage.tsx` — All section cards (MissionPlannerHeader, BracketSelector, TeamConfigurator, PreFlightIntel, WeeklySchedule)
- `EmptyStateCard.tsx`, `PlaybookEmptyState.tsx` — Empty state cards

### Visual spec
- Line length: 8px
- Line thickness: 1px
- Color: aviation-amber at 40% opacity
- Corner radius: Cards switch to `rounded-sm` (2px) or keep `rounded-lg` with brackets inset 4px from the border edge
- Brackets sit INSIDE the existing border

---

## Task 2: Scanline Texture

### Implementation
Add a `.scanlines` CSS class in `src/index.css`:

```css
.scanlines {
  position: relative;
}

.scanlines::after {
  content: '';
  position: absolute;
  inset: 0;
  background: repeating-linear-gradient(
    0deg,
    transparent,
    transparent 1px,
    rgba(0, 0, 0, 0.06) 1px,
    rgba(0, 0, 0, 0.06) 2px
  );
  pointer-events: none;
  z-index: 1;
  border-radius: inherit;
}
```

### Where applied
- `EmptyStateCard.tsx` — The main empty state container
- `PlaybookEmptyState.tsx` — The main empty state container
- `FlightAcademyTab.tsx` — Loading skeleton container
- `TacticalPlaybookTab.tsx` — Loading skeleton container
- Error boundary retry panels

### Visual spec
- Pattern: 2px repeat (1px transparent + 1px dark at 6% opacity)
- Static (no animation)
- Inherits border-radius from parent
- Does not interfere with pointer events

---

## Task 3: AI-Generated Badge

### Implementation
A small React component or inline JSX rendered when AI content is present.

```tsx
<span className="inline-flex items-center gap-1.5 px-2 py-0.5 text-[10px] font-mono uppercase tracking-widest text-green-400 bg-green-500/10 border border-green-500/30 rounded">
  <span className="w-1.5 h-1.5 rounded-full bg-green-400" aria-hidden="true" />
  AI Generated
</span>
```

### Where applied
- Top-right of `FlightAcademyTab` content (when `guide` is loaded)
- Top-right of `TacticalPlaybookTab` content (when `playbook` is loaded)

### Behavior
- Only visible when AI content has been generated and loaded
- Title attribute shows generation timestamp
- `aria-label="Content generated by AI"` for accessibility

---

## Task 4: Header Unification

### Problem
Mission Planner page uses its own header component (WAR THUNDER / Sim Matchup Tool + Home/Mission Planner nav links) that doesn't match the main app header (WT SIM / Matchup Intelligence System + Encyclopedia/Briefing nav).

### Solution
Modify `MissionPlannerPage.tsx` to use the existing app Header component from `src/components/layout/Header.tsx`, adding a "Mission Planner" navigation option to the main header.

**Changes:**
1. Add "Mission Planner" link to the existing Header component
2. Remove the custom header from MissionPlannerPage
3. Ensure routing works for all nav links

---

## Task 5: Bug Fixes

### 5a: Flight Academy Empty State Visibility
The config instructions card appears invisible/empty in the Flight Academy tab. Investigate whether:
- The card is rendering but has no visible styles
- The content is outside the viewport
- There's a z-index or overflow issue

### 5b: Weekly Schedule Rendering
The weekly schedule calendar in Mission Planner needs to be verified for:
- Horizontal overflow on smaller screens
- Proper table rendering
- Mobile fallback (collapsible details elements)

---

## Implementation Order

1. **Task 1:** Corner brackets CSS utility (global, impacts many components)
2. **Task 2:** Scanlines CSS utility (global, small)
3. **Task 3:** AI badge component (small, 2 files)
4. **Task 4:** Header unification (structural change)
5. **Task 5:** Bug fixes (investigation + fixes)

---

## Files to Modify

**CSS:**
- `src/index.css` — Add `.corner-brackets` and `.scanlines` classes

**Components (add corner-brackets class):**
- `src/components/flightacademy/FlightAcademyTab.tsx`
- `src/components/flightacademy/TacticalOverview.tsx`
- `src/components/flightacademy/PerformanceQuickStats.tsx`
- `src/components/flightacademy/CombatTacticsSection.tsx`
- `src/components/flightacademy/EnergyManagementDiagram.tsx`
- `src/components/flightacademy/PerformanceEnvelope.tsx`
- `src/components/flightacademy/MatchupThreatMatrix.tsx`
- `src/components/flightacademy/MECControlPanel.tsx`
- `src/components/flightacademy/EmptyStateCard.tsx`
- `src/components/tacticalplaybook/TacticalPlaybookTab.tsx`
- `src/components/tacticalplaybook/PlaybookEmptyState.tsx`
- `src/components/tacticalplaybook/ThreatAssessmentCard.tsx`
- `src/components/tacticalplaybook/EngagementPrinciplesCard.tsx`
- `src/components/tacticalplaybook/TacticalScenarioCard.tsx`
- `src/components/tacticalplaybook/AltitudeAdvantageChart.tsx`
- `src/components/missionplanner/MissionPlannerHeader.tsx`
- `src/components/missionplanner/BracketSelector.tsx`
- `src/components/missionplanner/TeamConfigurator.tsx`
- `src/components/missionplanner/PreFlightIntel.tsx`
- `src/components/missionplanner/WeeklySchedule.tsx`

**Header unification:**
- `src/components/layout/Header.tsx`
- `src/pages/MissionPlannerPage.tsx`
